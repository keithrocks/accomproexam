<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Accompro Final Exam</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body{
  font-family:Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
.container{
  max-width:1100px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:8px;
}
h1{text-align:center}
.timer{
  text-align:center;
  font-weight:bold;
  color:#c0392b;
  margin-bottom:20px;
}
.info-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:15px;
  margin-bottom:20px;
}
.info-grid input{
  width:100%;
  padding:8px;
}
.quiz-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:25px;
}
.question{margin-bottom:15px}
.question label{
  display:block;
  margin-left:15px;
}
button{
  padding:12px 25px;
  font-size:16px;
  cursor:pointer;
  display:block;
  margin:30px auto 0;
}
</style>
</head>

<body>
<div class="container">

<h1>Accompro Final Exam</h1>
<div class="timer" id="timer">Time Remaining: 45:00</div>

<div class="info-grid">
  <div>
    <strong>Full Name</strong>
    <input id="fullname">
    <strong>Subject</strong>
    <input id="subject">
  </div>
  <div>
    <strong>Course & Section</strong>
    <input id="course">
    <strong>Instructor</strong>
    <input id="instructor">
  </div>
</div>

<form id="quizForm">
  <div class="quiz-grid" id="quizGrid"></div>
</form>

<button type="button" onclick="submitExam(false)">Submit Exam</button>

</div>

<script>
emailjs.init("HXnfjwsUcLcGpmzMh");

// ================= TIMER =================
let timeLeft = 45 * 60;
const timerEl = document.getElementById("timer");

const countdown = setInterval(() => {
  const m = String(Math.floor(timeLeft / 60)).padStart(2, "0");
  const s = String(timeLeft % 60).padStart(2, "0");
  timerEl.textContent = `Time Remaining: ${m}:${s}`;

  if (timeLeft-- <= 0) {
    clearInterval(countdown);
    alert("⏰ Time is up. Exam will be submitted.");
    submitExam(true);
  }
}, 1000);

// ================= QUESTIONS (60) =================
const questions = [
  ["What do you call an Excel file?",["Worksheet","Workbook","Cell","Ribbon"],1],
  ["Rows in Excel run:",["Vertically","Diagonally","Horizontally","Randomly"],2],
  ["Columns are identified by:",["Numbers","Symbols","Letters","Colors"],2],
  ["Intersection of row and column:",["Box","Cell","Sheet","Range"],1],
  ["Top command area:",["Status Bar","Formula Bar","Ribbon","Name Box"],2],
  ["Displays cell content:",["Ribbon","Status Bar","Formula Bar","Sheet Tab"],2],
  ["Shows cell address:",["Status Bar","Name Box","Ribbon","Formula Bar"],1],
  ["AutoSum appears on:",["Ribbon","Status Bar","Sheet Tab","Name Box"],1],
  ["Switch worksheets:",["Ribbon","Sheet Tabs","Formula Bar","Cells"],1],
  ["VLOOKUP searches:",["Horizontal","Random","Vertical","Diagonal"],2],
  ["Leftmost column rule:",["SUMIFS","VLOOKUP","COUNTIFS","AVERAGEIFS"],1],
  ["Exact match uses:",["TRUE","FALSE","0","1"],1],
  ["#N/A means:",["Syntax","Column","Not found","File"],2],
  ["#REF! means:",["Invalid ref","Missing","Wrong sheet","Permission"],0],
  ["Pivot Tables are for:",["Design","Format","Summarize","Encrypt"],2],
  ["Pivot data needs:",["Colors","Headers","Macros","Charts"],1],
  ["Pivot auto-update:",["Yes","No","Sometimes","Macros"],1],
  ["Slicers are for:",["Edit","Filter","Calc","Protect"],1],
  ["SUMIFS allows:",["Single","Multiple","Text","Chart"],1],
  ["COUNTIFS does:",["Add","Count","Average","Format"],1],
  ["AVERAGEIFS:",["Sum","Count","Average","Text"],2],
  ["Combine text:",["LEFT","RIGHT","CONCAT","LEN"],2],
  ["Extract first chars:",["LEFT","MID","RIGHT","LEN"],0],
  ["Count characters:",["MID","LEN","RIGHT","LEFT"],1],
  ["Conditional formatting:",["Values","Appearance","Formulas","Files"],1],
  ["Highlight duplicates:",["Data Bars","Top","Highlight","Icons"],2],
  ["Data Bars show:",["Numbers","Trends","Text","Errors"],1],
  ["Relative ref:",["$A$1","A1","$A1","A$1"],1],
  ["Absolute ref:",["A1","A$1","$A1","$A$1"],3],
  ["$ symbol:",["Delete","Lock","Format","Calc"],1],
  ["Macros automate:",["Design","Reports","Tasks","Security"],2],
  ["Macro language:",["Java","Python","VBA","C++"],2],
  ["Macro extension:",[".xlsx",".xls",".xlsm",".docx"],2],
  ["Developer tab:",["Charts","Macros","Security","Print"],1],
  ["Macros improve:",["Speed","Accuracy","Efficiency","All"],3],
  ["Macro security:",["Off","Notify","Hidden","Removed"],1],
  ["Worksheet is:",["File","Page","Cell","Folder"],1],
  ["Workbook contains:",["One","Many","Macros","Charts"],1],
  ["Formula bar:",["Charts","Formulas","Theme","Sort"],1],
  ["Name box shows:",["Value","Cell","Formula","Chart"],1],
  ["COUNTIFS ignores:",["Zeros","Blanks","Numbers","Text"],1],
  ["SUMIFS syntax:",["Criteria","Sum range","Table","Macro"],1],
  ["Pivot Values show:",["Labels","Filters","Calculations","Design"],2],
  ["CF rule type:",["Icon Sets","Macros","Sheets","Charts"],0],
  ["Mixed reference:",["A1","$A$1","$A1","Sheet1!A1"],2],
  ["Rows are:",["A,B,C","1,2,3","I,II","Alpha"],1],
  ["Columns are:",["Yes","No","Sometimes","Tables"],0],
  ["Multiple conditions:",["SUM","IF","COUNTIFS","LEN"],2],
  ["Summarize data:",["Chart","Macro","Pivot","Theme"],2],
  ["Text length:",["LEN","MID","LEFT","RIGHT"],0],
  ["Formula starts with:",["#","=","$","@"],1],
  ["Join text:",["JOIN","MERGE","CONCAT","TEXTJOIN"],3],
  ["Trend chart:",["Pie","Bar","Line","Area"],2],
  ["Prevent bad input:",["Filter","Validation","Protect","Freeze"],1],
  ["Lock reference:",["$","@","!","&"],0],
  ["Count non-empty:",["COUNT","COUNTA","COUNTBLANK","SUM"],1],
  ["PivotTable tab:",["Home","Insert","Data","View"],1],
  ["Round numbers:",["ROUND","TRIM","INT","VALUE"],0],
  ["Hide rows:",["Filter","Group","Freeze","Split"],1],
  ["Macro file:",[".xlsx",".xlsm",".csv",".pdf"],1]
];

// ================= BUILD =================
const grid = document.getElementById("quizGrid");
questions.forEach((q,i)=>{
  const d = document.createElement("div");
  d.className="question";
  d.innerHTML = `<strong>${i+1}. ${q[0]}</strong>` +
    q[1].map((o,j)=>`<label><input type="radio" name="q${i}" value="${j}"> ${o}</label>`).join("");
  grid.appendChild(d);
});

// ================= SUBMIT =================
function submitExam(auto){
  const name = fullname.value.trim();
  if(!auto && !name){
    alert("Please enter Full Name.");
    return;
  }

  clearInterval(countdown);

  let score = 0;
  let message =
`Name: ${name || "Auto-Submitted"}
Course: ${course.value}
Subject: ${subject.value}
Instructor: ${instructor.value}

`;

  questions.forEach((q,i)=>{
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    if(sel && Number(sel.value) === q[2]) score++;
    message += `${i+1}. ${sel ? q[1][sel.value] : "No Answer"}\n`;
  });

  message += `\nFinal Score: ${score}/60`;

  emailjs.send(
  "service_6wxvrd5",
  "template_h17e9fg",
  {
    to_email: "keithrivera@keibatech.com",
    message: message
  },
  "HXnfjwsUcLcGpmzMh" // PUBLIC KEY — REQUIRED
).then(()=>{
    document.body.innerHTML =
      `<h1 style="text-align:center">Exam Submitted</h1>
       <p style="text-align:center;font-size:18px">Score: ${score}/60</p>`;
  }).catch(err=>{
    console.error(err);
    alert("Submission failed. Check console.");
  });
}
</script>
</body>
</html>
