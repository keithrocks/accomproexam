<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ACCOMPRO FINAL EXAMINATION</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; padding:20px }
.container { max-width:900px; margin:auto; background:#fff; padding:25px; border-radius:8px }
h1 { text-align:center }
.question { margin-bottom:15px }
.question label { display:block; margin-left:15px }
button { padding:12px 20px; font-size:16px; cursor:pointer }
</style>
</head>

<body>
<div class="container">
<h1>ACCOMPRO FINAL EXAMINATION</h1>

<label><strong>Full Name:</strong></label><br>
<input type="text" id="fullname" style="width:100%;padding:8px"><br><br>

<form id="quizForm"></form>

<button type="button" onclick="submitQuiz()">Submit Quiz</button>
</div>

<script>
emailjs.init("HXnfjwsUcLcGpmzMh");

// ================= QUESTIONS (60) =================
const questions = [
  {q:"What do you call an Excel file?", a:["Worksheet","Workbook","Cell","Ribbon"], c:1},
  {q:"Rows in Excel run:", a:["Vertically","Diagonally","Horizontally","Randomly"], c:2},
  {q:"Columns are identified by:", a:["Numbers","Symbols","Letters","Colors"], c:2},
  {q:"Intersection of row and column is called:", a:["Box","Cell","Sheet","Range"], c:1},
  {q:"Top command area in Excel:", a:["Status Bar","Formula Bar","Ribbon","Name Box"], c:2},
  {q:"Displays active cell content:", a:["Ribbon","Status Bar","Formula Bar","Sheet Tab"], c:2},
  {q:"Shows selected cell address:", a:["Status Bar","Name Box","Ribbon","Formula Bar"], c:1},
  {q:"Displays SUM and AVERAGE info:", a:["Ribbon","Status Bar","Sheet Tab","Name Box"], c:1},
  {q:"Used to switch worksheets:", a:["Ribbon","Sheet Tabs","Formula Bar","Cells"], c:1},
  {q:"VLOOKUP searches:", a:["Horizontally","Randomly","Vertically","Diagonally"], c:2},

  {q:"Leftmost column rule applies to:", a:["SUMIFS","VLOOKUP","COUNTIFS","AVERAGEIFS"], c:1},
  {q:"Exact match VLOOKUP uses:", a:["TRUE","FALSE","0","1"], c:1},
  {q:"#N/A means:", a:["Wrong syntax","Column error","Value not found","File missing"], c:2},
  {q:"#REF! means:", a:["Invalid reference","Missing value","Wrong sheet","Permission issue"], c:0},
  {q:"Pivot Tables are used to:", a:["Design","Format","Summarize data","Encrypt data"], c:2},
  {q:"Pivot data must have:", a:["Colors","Headers","Macros","Formulas"], c:1},
  {q:"Pivot Tables update automatically:", a:["Yes","No","Sometimes","Only with macros"], c:1},
  {q:"Slicers are used for:", a:["Editing","Filtering","Calculating","Protecting"], c:1},
  {q:"SUMIFS allows:", a:["Single criteria","Multiple criteria","Text only","Charts"], c:1},
  {q:"COUNTIFS does what?", a:["Adds","Counts","Averages","Formats"], c:1},

  {q:"AVERAGEIFS calculates:", a:["Sum","Count","Average","Text"], c:2},
  {q:"Text function to combine text:", a:["LEFT","RIGHT","CONCAT","LEN"], c:2},
  {q:"Extracts first characters:", a:["LEFT","MID","RIGHT","LEN"], c:0},
  {q:"Counts characters:", a:["MID","LEN","RIGHT","LEFT"], c:1},
  {q:"Conditional Formatting changes:", a:["Values","Appearance","Formulas","Files"], c:1},
  {q:"Highlights duplicates:", a:["Data Bars","Top Rules","Highlight Rules","Icon Sets"], c:2},
  {q:"Data Bars show:", a:["Numbers","Trends","Text","Errors"], c:1},
  {q:"Relative reference example:", a:["$A$1","A1","$A1","A$1"], c:1},
  {q:"Absolute reference example:", a:["A1","A$1","$A1","$A$1"], c:3},
  {q:"$ symbol purpose:", a:["Delete","Lock reference","Format","Calculate"], c:1},

  {q:"Macros automate:", a:["Design","Reports","Tasks","Security"], c:2},
  {q:"Macros are written in:", a:["Java","Python","VBA","C++"], c:2},
  {q:"Macro files extension:", a:[".xlsx",".xls",".xlsm",".docx"], c:2},
  {q:"Developer tab is for:", a:["Charts","Macros","Security","Printing"], c:1},
  {q:"Macros improve:", a:["Speed","Accuracy","Efficiency","All"], c:3},
  {q:"Macro security should be:", a:["Disabled","Enabled with Notification","Hidden","Removed"], c:1},
  {q:"Worksheet is:", a:["File","Page","Cell","Folder"], c:1},
  {q:"Workbook may contain:", a:["One sheet only","Multiple worksheets","Only macros","Only charts"], c:1},
  {q:"Formula Bar is used to:", a:["View charts","Enter formulas","Change theme","Sort data"], c:1},

  {q:"Name Box shows:", a:["Value","Cell address","Formula","Chart"], c:1},
  {q:"COUNTIFS ignores:", a:["Zeros","Blanks","Numbers","Text"], c:1},
  {q:"SUMIFS syntax requires:", a:["Criteria first","Sum range first","Table","Macro"], c:1},
  {q:"Pivot Values area displays:", a:["Labels","Filters","Calculations","Design"], c:2},
  {q:"Conditional Formatting rule type:", a:["Icon Sets","Macros","Sheets","Charts"], c:0},
  {q:"Mixed reference example:", a:["A1","$A$1","$A1","Sheet1!A1"], c:2},
  {q:"Rows are numbered:", a:["A,B,C","1,2,3","I,II,III","Alpha"], c:1},
  {q:"Columns are lettered:", a:["Yes","No","Sometimes","Only tables"], c:0},

  /* ===== ADDED QUESTIONS 48–60 ===== */
  {q:"Which function checks multiple conditions?", a:["SUM","IF","COUNTIFS","LEN"], c:2},
  {q:"Which Excel feature summarizes large datasets?", a:["Charts","Macros","Pivot Table","Themes"], c:2},
  {q:"Which function returns text length?", a:["LEN","MID","LEFT","RIGHT"], c:0},
  {q:"Which symbol starts a formula?", a:["#","=","$","@"], c:1},
  {q:"Which function joins text strings?", a:["JOIN","MERGE","CONCAT","TEXTJOIN"], c:3},
  {q:"Which chart best shows trends?", a:["Pie","Bar","Line","Area"], c:2},
  {q:"Which tool prevents invalid data entry?", a:["Filter","Validation","Protect Sheet","Freeze Panes"], c:1},
  {q:"Which feature locks cell references?", a:["$","@","!","&"], c:0},
  {q:"Which function counts non-empty cells?", a:["COUNT","COUNTA","COUNTBLANK","SUM"], c:1},
  {q:"Which tab contains PivotTable?", a:["Home","Insert","Data","View"], c:1},
  {q:"Which function rounds numbers?", a:["ROUND","TRIM","INT","VALUE"], c:0},
  {q:"Which feature hides rows?", a:["Filter","Group","Freeze","Split"], c:1},
  {q:"Which Excel file supports macros?", a:[".xlsx",".xlsm",".csv",".pdf"], c:1}
];

// ================= BUILD QUIZ =================
const form = document.getElementById("quizForm");
questions.forEach((item, i) => {
  const div = document.createElement("div");
  div.className = "question";
  div.innerHTML =
    `<p><strong>${i+1}. ${item.q}</strong></p>` +
    item.a.map((opt,j)=>`<label><input type="radio" name="q${i}" value="${j}"> ${opt}</label>`).join("");
  form.appendChild(div);
});

// ================= SUBMIT =================
function submitQuiz(){
  const name = document.getElementById("fullname").value.trim();
  if(!name){ alert("Enter full name."); return; }

  let score = 0;
  let resultText = `Name: ${name}\n\n`;

  questions.forEach((q,i)=>{
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    if(sel && Number(sel.value) === q.c) score++;
    resultText += `${i+1}. ${sel ? q.a[sel.value] : "No Answer"}\n`;
  });

  resultText += `\nFinal Score: ${score}/60`;

  emailjs.send(
    "service_6wxvrd5",
    "template_h17e9fg",
    {
      to_email: "keithrivera@keibatech.com",
      filename: `${name} - ${score}.txt`,
      message: resultText
    },
    "HXnfjwsUcLcGpmzMh"
  ).then(()=>{
    alert(`✅ Submitted successfully!\nScore: ${score}/60`);
  }).catch(err=>{
    console.error(err);
    alert("❌ Email failed. Check console.");
  });
}
</script>
</body>
</html>
