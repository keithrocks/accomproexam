<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Accompro Final Exam</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}

.container{
  max-width:1200px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:8px;
}

h1{
  text-align:center;
  margin-bottom:10px;
}

.header{
  margin-bottom:20px;
}

.header label{
  font-weight:bold;
}

.header input{
  width:100%;
  padding:8px;
  margin-bottom:15px;
}

.timer{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  color:#c0392b;
  margin-bottom:20px;
}

.quiz-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:25px;
}

.question{
  break-inside:avoid;
}

.question p{
  font-weight:bold;
}

.question label{
  display:block;
  margin-left:15px;
}

.actions{
  text-align:center;
  margin-top:30px;
}

button{
  padding:12px 25px;
  font-size:16px;
  cursor:pointer;
}

.submitted{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  color:#27ae60;
  margin-top:40px;
}
</style>
</head>

<body>
<div class="container" id="examContainer">

<h1>Accompro Final Exam</h1>

<div class="timer" id="timer">Time Remaining: 45:00</div>

<div class="header">
  <label>Full Name:</label>
  <input type="text" id="fullname">
</div>

<form id="quizForm">
  <div class="quiz-grid" id="quizGrid"></div>
</form>

<div class="actions">
  <button type="button" id="submitBtn" onclick="submitQuiz(false)">Submit Exam</button>
</div>

</div>

<script>
emailjs.init("HXnfjwsUcLcGpmzMh");

/* ================= TIMER ================= */
let timeLeft = 45 * 60;
const timerEl = document.getElementById("timer");

const countdown = setInterval(() => {
  const m = String(Math.floor(timeLeft / 60)).padStart(2,"0");
  const s = String(timeLeft % 60).padStart(2,"0");
  timerEl.textContent = `Time Remaining: ${m}:${s}`;

  if(timeLeft <= 0){
    clearInterval(countdown);
    alert("‚è∞ Time is up! Exam will be submitted automatically.");
    submitQuiz(true);
  }
  timeLeft--;
}, 1000);

/* ================= QUESTIONS (60) ================= */
const questions = [
  {q:"What do you call an Excel file?", a:["Worksheet","Workbook","Cell","Ribbon"], c:1},
  {q:"Rows in Excel run:", a:["Vertically","Diagonally","Horizontally","Randomly"], c:2},
  {q:"Columns are identified by:", a:["Numbers","Symbols","Letters","Colors"], c:2},
  {q:"Intersection of row and column is called:", a:["Box","Cell","Sheet","Range"], c:1},
  {q:"Top command area in Excel:", a:["Status Bar","Formula Bar","Ribbon","Name Box"], c:2},
  {q:"Displays active cell content:", a:["Ribbon","Status Bar","Formula Bar","Sheet Tab"], c:2},
  {q:"Shows selected cell address:", a:["Status Bar","Name Box","Ribbon","Formula Bar"], c:1},
  {q:"Displays SUM and AVERAGE info:", a:["Ribbon","Status Bar","Sheet Tab","Name Box"], c:1},
  {q:"Used to switch worksheets:", a:["Ribbon","Sheet Tabs","Formula Bar","Cells"], c:1},
  {q:"VLOOKUP searches:", a:["Horizontally","Randomly","Vertically","Diagonally"], c:2},

  {q:"Leftmost column rule applies to:", a:["SUMIFS","VLOOKUP","COUNTIFS","AVERAGEIFS"], c:1},
  {q:"Exact match VLOOKUP uses:", a:["TRUE","FALSE","0","1"], c:1},
  {q:"#N/A means:", a:["Wrong syntax","Column error","Value not found","File missing"], c:2},
  {q:"#REF! means:", a:["Invalid reference","Missing value","Wrong sheet","Permission issue"], c:0},
  {q:"Pivot Tables are used to:", a:["Design","Format","Summarize data","Encrypt data"], c:2},
  {q:"Pivot data must have:", a:["Colors","Headers","Macros","Formulas"], c:1},
  {q:"Pivot Tables update automatically:", a:["Yes","No","Sometimes","Only with macros"], c:1},
  {q:"Slicers are used for:", a:["Editing","Filtering","Calculating","Protecting"], c:1},
  {q:"SUMIFS allows:", a:["Single criteria","Multiple criteria","Text only","Charts"], c:1},
  {q:"COUNTIFS does what?", a:["Adds","Counts","Averages","Formats"], c:1},

  {q:"AVERAGEIFS calculates:", a:["Sum","Count","Average","Text"], c:2},
  {q:"Text function to combine text:", a:["LEFT","RIGHT","CONCAT","LEN"], c:2},
  {q:"Extracts first characters:", a:["LEFT","MID","RIGHT","LEN"], c:0},
  {q:"Counts characters:", a:["MID","LEN","RIGHT","LEFT"], c:1},
  {q:"Conditional Formatting changes:", a:["Values","Appearance","Formulas","Files"], c:1},
  {q:"Highlights duplicates:", a:["Data Bars","Top Rules","Highlight Rules","Icon Sets"], c:2},
  {q:"Data Bars show:", a:["Numbers","Trends","Text","Errors"], c:1},
  {q:"Relative reference example:", a:["$A$1","A1","$A1","A$1"], c:1},
  {q:"Absolute reference example:", a:["A1","A$1","$A1","$A$1"], c:3},
  {q:"$ symbol purpose:", a:["Delete","Lock reference","Format","Calculate"], c:1},

  {q:"Macros automate:", a:["Design","Reports","Tasks","Security"], c:2},
  {q:"Macros are written in:", a:["Java","Python","VBA","C++"], c:2},
  {q:"Macro files extension:", a:[".xlsx",".xls",".xlsm",".docx"], c:2},
  {q:"Developer tab is for:", a:["Charts","Macros","Security","Printing"], c:1},
  {q:"Macros improve:", a:["Speed","Accuracy","Efficiency","All"], c:3},
  {q:"Macro security should be:", a:["Disabled","Enabled with Notification","Hidden","Removed"], c:1},
  {q:"Worksheet is:", a:["File","Page","Cell","Folder"], c:1},
  {q:"Workbook may contain:", a:["One sheet only","Multiple worksheets","Only macros","Only charts"], c:1},
  {q:"Formula Bar is used to:", a:["View charts","Enter formulas","Change theme","Sort data"], c:1},

  {q:"Name Box shows:", a:["Value","Cell address","Formula","Chart"], c:1},
  {q:"COUNTIFS ignores:", a:["Zeros","Blanks","Numbers","Text"], c:1},
  {q:"SUMIFS syntax requires:", a:["Criteria first","Sum range first","Table","Macro"], c:1},
  {q:"Pivot Values area displays:", a:["Labels","Filters","Calculations","Design"], c:2},
  {q:"Conditional Formatting rule type:", a:["Icon Sets","Macros","Sheets","Charts"], c:0},
  {q:"Mixed reference example:", a:["A1","$A$1","$A1","Sheet1!A1"], c:2},
  {q:"Rows are numbered:", a:["A,B,C","1,2,3","I,II,III","Alpha"], c:1},
  {q:"Columns are lettered:", a:["Yes","No","Sometimes","Only tables"], c:0}
];

/* ================= BUILD QUIZ ================= */
const grid = document.getElementById("quizGrid");
questions.forEach((item,i)=>{
  const div = document.createElement("div");
  div.className = "question";
  div.innerHTML =
    `<p>${i+1}. ${item.q}</p>` +
    item.a.map((opt,j)=>`
      <label>
        <input type="radio" name="q${i}" value="${j}">
        ${opt}
      </label>`).join("");
  grid.appendChild(div);
});

/* ================= SUBMIT ================= */
function submitQuiz(auto){
  const name = document.getElementById("fullname").value.trim();
  if(!auto && !name){
    alert("Enter full name.");
    return;
  }

  let score = 0;
  let result = `Name: ${name || "Auto-Submitted"}\n\n`;

  questions.forEach((q,i)=>{
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    if(sel && Number(sel.value) === q.c) score++;
    result += `${i+1}. ${sel ? q.a[sel.value] : "No Answer"}\n`;
  });

  result += `\nFinal Score: ${score}/60`;

  emailjs.send(
    "service_6wxvrd5",
    "template_h17e9fg",
    {
      to_email: "keithrivera@keibatech.com",
      filename: `${name || "Auto"} - ${score}.txt`,
      message: result
    }
  ).then(()=>{
    clearInterval(countdown);

    // üîí CLEAR EXAM PAGE
    document.getElementById("examContainer").innerHTML =
      `<div class="submitted">
        ‚úÖ Exam successfully submitted.<br>
        You may now close this page.
      </div>`;

  }).catch(err=>{
    console.error(err);
    alert("‚ùå Submission failed. Check console.");
  });
}
</script>
</body>
</html>
