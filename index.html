<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Excel Skills Quiz</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px
}

.container {
  max-width:1100px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:8px
}

h1 {
  text-align:center;
  margin-bottom:10px
}

.timer {
  text-align:center;
  font-size:20px;
  font-weight:bold;
  color:#c0392b;
  margin-bottom:20px
}

/* TOP INFO GRID */
.info-grid {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px;
  margin-bottom:20px
}

.info-grid label {
  font-weight:bold
}

.info-grid input {
  width:100%;
  padding:8px;
  margin-top:5px
}

/* EXAM GRID */
.exam-grid {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px
}

.question {
  margin-bottom:15px
}

.question label {
  display:block;
  margin-left:15px
}

button {
  padding:12px 20px;
  font-size:16px;
  cursor:pointer;
  margin-top:20px
}

@media(max-width:900px){
  .exam-grid {
    grid-template-columns:1fr
  }
  .info-grid {
    grid-template-columns:1fr
  }
}
</style>
</head>

<body>
<div class="container">

<h1>Excel Skills Quiz (60 Items)</h1>

<div class="timer" id="timer">Time Remaining: 01:00:00</div>

<!-- STUDENT INFO -->
<div class="info-grid">
  <div>
    <label>Full Name</label>
    <input type="text" id="fullname">
    <label style="margin-top:10px">Subject Name</label>
    <input type="text" id="subject">
  </div>

  <div>
    <label>Course & Section</label>
    <input type="text" id="course">
    <label style="margin-top:10px">Instructor</label>
    <input type="text" id="instructor">
  </div>
</div>

<form id="quizForm" class="exam-grid"></form>

<button type="button" onclick="submitQuiz()">Submit Quiz</button>

</div>

<script>
// ================= EMAILJS =================
emailjs.init("HXnfjwsUcLcGpmzMh");

// ================= TIMER ==================
let timeLeft = 3600; // 1 hour in seconds
const timerEl = document.getElementById("timer");

const countdown = setInterval(() => {
  const h = String(Math.floor(timeLeft / 3600)).padStart(2,"0");
  const m = String(Math.floor((timeLeft % 3600) / 60)).padStart(2,"0");
  const s = String(timeLeft % 60).padStart(2,"0");
  timerEl.textContent = `Time Remaining: ${h}:${m}:${s}`;

  if(timeLeft <= 0){
    clearInterval(countdown);
    alert("⏰ Time is up! Exam will be submitted automatically.");
    submitQuiz(true);
  }
  timeLeft--;
},1000);

// ================= QUESTIONS =================
// (UNCHANGED – same 60 questions from Checkpoint 1)
const questions = [...Array(60)].map((_,i)=>window.questions ? window.questions[i] : null);
// NOTE: keep your SAME 60-question array here
// (Use the exact questions array from Checkpoint 1)

// ================= BUILD QUIZ =================
const form = document.getElementById("quizForm");

questions.forEach((item, i) => {
  const div = document.createElement("div");
  div.className = "question";
  div.innerHTML =
    `<p><strong>${i+1}. ${item.q}</strong></p>` +
    item.a.map((opt,j)=>
      `<label><input type="radio" name="q${i}" value="${j}"> ${opt}</label>`
    ).join("");
  form.appendChild(div);
});

// ================= SUBMIT =================
function submitQuiz(auto=false){
  const name = fullname.value.trim();
  const course = document.getElementById("course").value.trim();
  const subject = document.getElementById("subject").value.trim();
  const instructor = document.getElementById("instructor").value.trim();

  if(!auto && (!name || !course || !subject || !instructor)){
    alert("Please complete all student information.");
    return;
  }

  let score = 0;
  let resultText =
`Name: ${name}
Course & Section: ${course}
Subject: ${subject}
Instructor: ${instructor}

`;

  questions.forEach((q,i)=>{
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    if(sel && Number(sel.value) === q.c) score++;
    resultText += `${i+1}. ${sel ? q.a[sel.value] : "No Answer"}\n`;
  });

  resultText += `\nFinal Score: ${score}/60`;

  emailjs.send(
    "service_6wxvrd5",
    "template_h17e9fg",
    {
      to_email: "keithrivera@keibatech.com",
      filename: `${name || "Student"} - ${score}.txt`,
      message: resultText
    },
    "HXnfjwsUcLcGpmzMh"
  ).then(()=>{
    alert(`✅ Exam submitted!\nScore: ${score}/60`);
    clearInterval(countdown);
  }).catch(err=>{
    console.error(err);
    alert("❌ Submission failed. Check connection.");
  });
}
</script>

</body>
</html>
