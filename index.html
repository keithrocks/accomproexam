<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Accompro Final Examination</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body{
  font-family:Arial,sans-serif;
  background:#f4f6f8;
  padding:20px;
}
.container{
  max-width:1200px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:8px;
}
h1{text-align:center;}
.timer{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  color:#c0392b;
  margin-bottom:20px;
}
.info{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:15px;
  margin-bottom:20px;
}
.info label{font-weight:bold;}
.info input{width:100%;padding:8px;}
.quiz-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px;
}
.question{margin-bottom:15px;}
.question label{display:block;margin-left:15px;}
.submit-wrap{text-align:center;margin-top:25px;}
button{padding:12px 25px;font-size:16px;cursor:pointer;}
</style>
</head>

<body>
<div class="container">

<h1>Accompro Final Examination</h1>

<div class="timer" id="timer">Time Remaining: 45:00</div>

<div class="info">
  <div><label>Full Name</label><input type="text" id="fullname"></div>
  <div><label>Course / Section</label><input type="text" id="course"></div>
  <div><label>Subject</label><input type="text" id="subject"></div>
  <div><label>Instructor</label><input type="text" id="instructor"></div>
</div>

<form id="quizForm">
  <div class="quiz-grid" id="quizGrid"></div>
</form>

<div class="submit-wrap">
  <button type="button" onclick="submitQuiz(false)">Submit Exam</button>
</div>

</div>

<script>
emailjs.init("HXnfjwsUcLcGpmzMh");

/* ================= TIMER ================= */
let timeLeft = 45 * 60;
const timerEl = document.getElementById("timer");

const countdown = setInterval(()=>{
  const m = String(Math.floor(timeLeft/60)).padStart(2,"0");
  const s = String(timeLeft%60).padStart(2,"0");
  timerEl.textContent = `Time Remaining: ${m}:${s}`;

  if(timeLeft <= 0){
    clearInterval(countdown);
    alert("â° Time is up! Auto-submitting exam.");
    submitQuiz(true);
  }
  timeLeft--;
},1000);

/* ================= QUESTIONS (60) ================= */
const questions = [
  {q:"What do you call an Excel file?",a:["Worksheet","Workbook","Cell","Ribbon"],c:1},
  {q:"Rows in Excel run:",a:["Vertically","Diagonally","Horizontally","Randomly"],c:2},
  {q:"Columns are identified by:",a:["Numbers","Symbols","Letters","Colors"],c:2},
  {q:"Intersection of row and column is called:",a:["Box","Cell","Sheet","Range"],c:1},
  {q:"Top command area in Excel:",a:["Status Bar","Formula Bar","Ribbon","Name Box"],c:2},
  {q:"Displays active cell content:",a:["Ribbon","Status Bar","Formula Bar","Sheet Tab"],c:2},
  {q:"Shows selected cell address:",a:["Status Bar","Name Box","Ribbon","Formula Bar"],c:1},
  {q:"Displays SUM and AVERAGE info:",a:["Ribbon","Status Bar","Sheet Tab","Name Box"],c:1},
  {q:"Used to switch worksheets:",a:["Ribbon","Sheet Tabs","Formula Bar","Cells"],c:1},
  {q:"VLOOKUP searches:",a:["Horizontally","Randomly","Vertically","Diagonally"],c:2},

  {q:"Leftmost column rule applies to:",a:["SUMIFS","VLOOKUP","COUNTIFS","AVERAGEIFS"],c:1},
  {q:"Exact match VLOOKUP uses:",a:["TRUE","FALSE","0","1"],c:1},
  {q:"#N/A means:",a:["Wrong syntax","Column error","Value not found","File missing"],c:2},
  {q:"#REF! means:",a:["Invalid reference","Missing value","Wrong sheet","Permission issue"],c:0},
  {q:"Pivot Tables are used to:",a:["Design","Format","Summarize data","Encrypt data"],c:2},
  {q:"Pivot data must have:",a:["Colors","Headers","Macros","Formulas"],c:1},
  {q:"Pivot Tables update automatically:",a:["Yes","No","Sometimes","Only with macros"],c:1},
  {q:"Slicers are used for:",a:["Editing","Filtering","Calculating","Protecting"],c:1},
  {q:"SUMIFS allows:",a:["Single criteria","Multiple criteria","Text only","Charts"],c:1},
  {q:"COUNTIFS does what?",a:["Adds","Counts","Averages","Formats"],c:1},

  {q:"AVERAGEIFS calculates:",a:["Sum","Count","Average","Text"],c:2},
  {q:"Text function to combine text:",a:["LEFT","RIGHT","CONCAT","LEN"],c:2},
  {q:"Extracts first characters:",a:["LEFT","MID","RIGHT","LEN"],c:0},
  {q:"Counts characters:",a:["MID","LEN","RIGHT","LEFT"],c:1},
  {q:"Conditional Formatting changes:",a:["Values","Appearance","Formulas","Files"],c:1},
  {q:"Highlights duplicates:",a:["Data Bars","Top Rules","Highlight Rules","Icon Sets"],c:2},
  {q:"Data Bars show:",a:["Numbers","Trends","Text","Errors"],c:1},
  {q:"Relative reference example:",a:["$A$1","A1","$A1","A$1"],c:1},
  {q:"Absolute reference example:",a:["A1","A$1","$A1","$A$1"],c:3},
  {q:"$ symbol purpose:",a:["Delete","Lock reference","Format","Calculate"],c:1},

  {q:"Macros automate:",a:["Design","Reports","Tasks","Security"],c:2},
  {q:"Macros are written in:",a:["Java","Python","VBA","C++"],c:2},
  {q:"Macro files extension:",a:[".xlsx",".xls",".xlsm",".docx"],c:2},
  {q:"Developer tab is for:",a:["Charts","Macros","Security","Printing"],c:1},
  {q:"Macros improve:",a:["Speed","Accuracy","Efficiency","All"],c:3},
  {q:"Macro security should be:",a:["Disabled","Enabled with Notification","Hidden","Removed"],c:1},
  {q:"Worksheet is:",a:["File","Page","Cell","Folder"],c:1},
  {q:"Workbook may contain:",a:["One sheet only","Multiple worksheets","Only macros","Only charts"],c:1},
  {q:"Formula Bar is used to:",a:["View charts","Enter formulas","Change theme","Sort data"],c:1},

  {q:"Which function counts non-empty cells?",a:["COUNT","COUNTA","COUNTBLANK","SUM"],c:1},
  {q:"Which symbol starts an Excel formula?",a:["#","=","$","@"],c:1},
  {q:"Which tab contains PivotTable?",a:["Home","Insert","Data","View"],c:1},
  {q:"Which function rounds numbers?",a:["ROUND","INT","TRIM","VALUE"],c:0},
  {q:"Which Excel file supports macros?",a:[".xlsx",".xlsm",".csv",".pdf"],c:1},
  {q:"Which chart best shows trends?",a:["Pie","Bar","Line","Area"],c:2},
  {q:"Which tool prevents invalid data entry?",a:["Filter","Validation","Protect Sheet","Freeze Panes"],c:1},
  {q:"Which feature locks cell references?",a:["$","@","!","&"],c:0},
  {q:"Which function removes extra spaces?",a:["TRIM","CLEAN","LEN","TEXT"],c:0}
];

/* ================= SHUFFLE ================= */
function shuffleArray(arr){
  for(let i = arr.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}
shuffleArray(questions);

/* ================= BUILD ================= */
const grid = document.getElementById("quizGrid");
questions.forEach((q,i)=>{
  const d = document.createElement("div");
  d.className="question";
  d.innerHTML =
    `<p><strong>${i+1}. ${q.q}</strong></p>` +
    q.a.map((o,j)=>
      `<label><input type="radio" name="q${i}" value="${j}"> ${o}</label>`
    ).join("");
  grid.appendChild(d);
});

/* ================= SUBMIT ================= */
function submitQuiz(auto){
  const name = document.getElementById("fullname").value.trim();
  if(!auto && !name){ alert("Enter full name."); return; }

  let score = 0;
  let msg = `Name: ${name || "Auto-Submitted"}\n\n`;

  questions.forEach((q,i)=>{
    const s = document.querySelector(`input[name="q${i}"]:checked`);
    if(s && Number(s.value) === q.c) score++;
    msg += `${i+1}. ${s ? q.a[s.value] : "No Answer"}\n`;
  });

  msg += `\nFinal Score: ${score}/60`;

  emailjs.send(
    "service_6wxvrd5",
    "template_h17e9fg",
    { to_email:"keithrivera@keibatech.com", message: msg }
  ).then(()=>{
    clearInterval(countdown);
    alert(`Submitted!\nScore: ${score}/60`);
  });
}
</script>
</body>
</html>
